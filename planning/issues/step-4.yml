# Step 4 — LLM UI mockups + clickable prototype + designer skills.
# Constraint: keep issue bodies compact to fit strict token budgets.

AI-Agent-Framework:
  - number: "S4-BE-01"
    size_estimate: "M"
    title: "Step 4 — OpenAI Images client + mockup artifact writer"
    labels:
      - step:4
      - backend/ux-mockups
      - size:M
    body: |
      ## Goal / Problem Statement
      Add a minimal OpenAI Images integration that can generate UI mock images and write them to a deterministic local artifact folder.

      ## Scope
      ### In Scope
      - Add a small image client wrapper (env-keyed, no secrets on disk).
      - Write artifacts under `.tmp/mockups/issue-<n>/` (images + `index.html`).
      - Provide a single callable entry-point used by the workflow agent.
      ### Out of Scope
      - Pixel-perfect brand design.
      - Complex multi-page prototypes.
      ### Dependencies
      - OpenAI Images API (model: `gpt-image-1`) via `OPENAI_API_KEY`.

      ## Acceptance Criteria
      - [ ] A module exists that can generate at least one mock image when `OPENAI_API_KEY` is set.
      - [ ] Outputs are written under `.tmp/mockups/issue-<n>/` with an `index.html` prototype.
      - [ ] When the key is missing, the feature exits gracefully with an actionable message.

      ## Technical Approach
      - Add a small service (pure Python) that builds a prompt, calls OpenAI Images, and writes files.

      ## Testing Requirements
      - `pytest tests/unit -q`
      - `pytest tests/unit -k mockup -q`

      ## Documentation Updates
      - [ ] Document `OPENAI_API_KEY` setup and artifact output location.

      ## Cross-Repository Coordination
      None.

  - number: "S4-BE-02"
    size_estimate: "S"
    title: "Step 4 — Add designer skills: design guidelines + coder change plan"
    labels:
      - step:4
      - backend/skills
      - size:S
    body: |
      ## Goal / Problem Statement
      Implement two explicit "designer" skills so the agent can produce (1) design guidelines when mockups are approved and (2) a coder-facing change plan that can be turned into issue specs.

      ## Scope
      ### In Scope
      - Add a `design_guidelines` skill returning concise markdown.
      - Add a `coder_change_plan` skill returning markdown + machine-parsable YAML stubs.
      - Register skills in the backend skill registry.
      ### Out of Scope
      - Full UI implementation.
      - Non-deterministic, tool-heavy skills.
      ### Dependencies
      - Existing skills framework under `apps/api/skills/`.

      ## Acceptance Criteria
      - [ ] `GET /api/v1/agents/<id>/skills` lists both new skills.
      - [ ] Each skill returns a `SkillResult` envelope with deterministic structure.
      - [ ] `coder_change_plan` output includes a clearly delimited YAML block.

      ## Technical Approach
      - Add two skill classes + registry entries.

      ## Testing Requirements
      - `pytest tests/unit -k "skills" -q`

      ## Documentation Updates
      - [ ] Add short usage docs for both skills.

      ## Cross-Repository Coordination
      None.

  - number: "S4-BE-03"
    size_estimate: "M"
    title: "Step 4 — Workflow Phase 2.6: generate mockups + prototype before coding"
    labels:
      - step:4
      - backend/agents
      - size:M
    body: |
      ## Goal / Problem Statement
      Insert a new workflow phase (2.6) after the UX gate to produce UI mock images and a clickable prototype before implementation begins.

      ## Scope
      ### In Scope
      - Add Phase 2.6 in `agents/autonomous_workflow_agent.py`.
      - Persist evidence under `.tmp/mockups/issue-<n>/` and link it in logs.
      - Call designer skills after mockup approval (PASS).
      ### Out of Scope
      - Client-side UI work.
      - Fancy navigation/animation beyond static clickable hotspots.
      ### Dependencies
      - Step 4 mockup generator (S4-BE-01).
      - Designer skills (S4-BE-02).

      ## Acceptance Criteria
      - [ ] Phase order is: UX gate (2.5) → mockups (2.6) → coding.
      - [ ] If image generation is unavailable, workflow continues but records a clear skip reason.
      - [ ] Evidence is persisted to `.tmp/` for later review.

      ## Technical Approach
      - Add a small phase method that invokes generator + skills.

      ## Testing Requirements
      - `pytest tests/unit -k "workflow" -q`

      ## Documentation Updates
      - [ ] Update workflow docs to mention Phase 2.6 artifacts.

      ## Cross-Repository Coordination
      None.
