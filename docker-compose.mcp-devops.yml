name: devops-mcp

services:
  docker-compose-mcp:
    build:
      context: .
      dockerfile: docker/mcp-devops-docker-compose/Dockerfile
    container_name: devops-docker-compose-mcp
    restart: unless-stopped
    environment:
      - DOCKER_COMPOSE_MCP_PORT=3015
      - DOCKER_COMPOSE_MCP_HOST=0.0.0.0
      - DOCKER_COMPOSE_MCP_REPO_ROOT=/workspace
      - DOCKER_COMPOSE_MCP_AUDIT_DIR=/workspace/.tmp/mcp-docker-compose
    ports:
      - "127.0.0.1:3015:3015"
    volumes:
      - ./:/workspace
      - /var/run/docker.sock:/var/run/docker.sock

  test-runner-mcp:
    build:
      context: .
      dockerfile: docker/mcp-devops-test-runner/Dockerfile
    container_name: devops-test-runner-mcp
    restart: unless-stopped
    environment:
      - TEST_RUNNER_MCP_PORT=3016
      - TEST_RUNNER_MCP_HOST=0.0.0.0
      - TEST_RUNNER_MCP_REPO_ROOT=/workspace
      - TEST_RUNNER_MCP_AUDIT_DIR=/workspace/.tmp/mcp-test-runner
      - TEST_RUNNER_PYTHON=python3
    ports:
      - "127.0.0.1:3016:3016"
    volumes:
      - ./:/workspace
