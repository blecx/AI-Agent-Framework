{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "‚öôÔ∏è Auto: Apply Safe Approval",
      "type": "shell",
      "command": "bash",
      "args": ["${workspaceFolder}/scripts/setup-low-approval.sh", "safe"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "runOptions": {
        "runOn": "folderOpen"
      },
      "presentation": {
        "reveal": "never",
        "panel": "shared",
        "focus": false,
        "clear": false
      }
    },
    {
      "label": "ü§ñ Work on Issue (Autonomous)",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/work-issue.py",
      "args": ["--issue", "${input:issueNumber}"],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üîç Work on Issue (Dry Run)",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/work-issue.py",
      "args": ["--issue", "${input:issueNumber}", "--dry-run"],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üí¨ Work on Issue (Interactive)",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/work-issue.py",
      "args": ["--issue", "${input:issueNumber}", "--interactive"],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üìã Select Next Issue",
      "type": "shell",
      "command": "${workspaceFolder}/next-issue",
      "args": [],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üì¶ Select Next PR",
      "type": "shell",
      "command": "${workspaceFolder}/next-pr",
      "args": [],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üîÄ Merge PR",
      "type": "shell",
      "command": "${workspaceFolder}/scripts/prmerge",
      "args": ["${input:prNumber}"],
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üóÑÔ∏è Archive Goals (.tmp)",
      "type": "shell",
      "command": "bash",
      "args": ["${workspaceFolder}/scripts/archive-goals-safe.sh"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "üóÑÔ∏è Archive Goals (.tmp, move)",
      "type": "shell",
      "command": "bash",
      "args": ["${workspaceFolder}/scripts/archive-goals-safe.sh", "--move"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": true
      },
      "group": "none"
    },
    {
      "label": "‚úÖ Backend: Format & Lint",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": [
        "-m",
        "black",
        "apps/api/",
        "&&",
        "${workspaceFolder}/.venv/bin/python",
        "-m",
        "flake8",
        "apps/api/"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": false,
        "clear": false
      },
      "group": {
        "kind": "build",
        "isDefault": false
      }
    },
    {
      "label": "üß™ Backend: Run Tests",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": ["-m", "pytest", "tests/", "-v"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": true
      },
      "group": {
        "kind": "test",
        "isDefault": true
      }
    },
    {
      "label": "üß™ Backend: Run Tests (Quick)",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": ["-m", "pytest", "tests/", "-q", "--tb=short"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": false,
        "clear": true
      },
      "group": "test"
    },
    {
      "label": "üöÄ Backend: Start API Server",
      "type": "shell",
      "command": "cd apps/api && PROJECT_DOCS_PATH=../../projectDocs ${workspaceFolder}/.venv/bin/uvicorn main:app --reload",
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "Started reloader process",
          "endsPattern": "Application startup complete"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      }
    },
    {
      "label": "üé® Frontend: Start Dev Server",
      "type": "shell",
      "command": "npm",
      "args": ["run", "dev"],
      "options": {
        "cwd": "${workspaceFolder}/_external/AI-Agent-Framework-Client/client"
      },
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "VITE.*ready in",
          "endsPattern": "Local:.*http"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      }
    },
    {
      "label": "üöÄ Dev Stack: Supervised",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": ["-u", "${workspaceFolder}/scripts/dev_stack_supervisor.py"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "isBackground": true,
      "runOptions": {
        "runOn": "folderOpen"
      },
      "problemMatcher": {
        "pattern": {
          "regexp": "^$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "dev-stack-supervisor started",
          "endsPattern": "frontend: http://127.0.0.1:5173"
        }
      },
      "presentation": {
        "reveal": "never",
        "panel": "dedicated",
        "focus": false,
        "clear": false
      }
    },
    {
      "label": "üèóÔ∏è Frontend: Build",
      "type": "shell",
      "command": "npm",
      "args": ["run", "build"],
      "options": {
        "cwd": "${workspaceFolder}/_external/AI-Agent-Framework-Client/client"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": false,
        "clear": false
      },
      "group": {
        "kind": "build",
        "isDefault": false
      }
    },
    {
      "label": "‚úÖ Frontend: Lint",
      "type": "shell",
      "command": "npm",
      "args": ["run", "lint"],
      "options": {
        "cwd": "${workspaceFolder}/_external/AI-Agent-Framework-Client/client"
      },
      "problemMatcher": ["$eslint-stylish"],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": false,
        "clear": false
      },
      "group": "build"
    },
    {
      "label": "üê≥ Docker: Build & Start",
      "type": "shell",
      "command": "docker",
      "args": ["compose", "up", "--build"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "isBackground": true,
      "problemMatcher": {
        "pattern": {
          "regexp": "^$",
          "file": 1,
          "location": 2,
          "message": 3
        },
        "background": {
          "activeOnStart": true,
          "beginsPattern": "Creating network",
          "endsPattern": "Started"
        }
      },
      "presentation": {
        "reveal": "always",
        "panel": "dedicated",
        "focus": false,
        "clear": true
      }
    },
    {
      "label": "üõë Docker: Stop",
      "type": "shell",
      "command": "docker",
      "args": ["compose", "down"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": false,
        "clear": false
      }
    },
    {
      "label": "‚úÖ Validate: Full Backend",
      "dependsOn": ["‚úÖ Backend: Format & Lint", "üß™ Backend: Run Tests"],
      "dependsOrder": "sequence",
      "problemMatcher": [],
      "group": {
        "kind": "build",
        "isDefault": true
      }
    },
    {
      "label": "üöÄ Start: Full Stack (Dev)",
      "dependsOn": ["üöÄ Dev Stack: Supervised"],
      "problemMatcher": []
    },
    {
      "label": "üß™ Dev Stack: Smoke Test",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": ["${workspaceFolder}/scripts/dev_stack_smoke_test.py"],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": true
      },
      "group": "test"
    },
    {
      "label": "üß≠ Step2 Queue: Check (Dry Run)",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": [
        "${workspaceFolder}/scripts/step2_backend_queue.py",
        "--dry-run",
        "--sync-tracker",
        "--sleep-seconds",
        "1.0"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": true
      },
      "group": "test"
    },
    {
      "label": "üß≠ Step2 Queue: Apply + Sync",
      "type": "shell",
      "command": "${workspaceFolder}/.venv/bin/python",
      "args": [
        "${workspaceFolder}/scripts/step2_backend_queue.py",
        "--apply",
        "--sync-tracker",
        "--sleep-seconds",
        "1.0"
      ],
      "options": {
        "cwd": "${workspaceFolder}"
      },
      "problemMatcher": [],
      "presentation": {
        "reveal": "always",
        "panel": "shared",
        "focus": true,
        "clear": true
      },
      "group": "none"
    }
  ],
  "inputs": [
    {
      "id": "issueNumber",
      "type": "promptString",
      "description": "Enter GitHub issue number",
      "default": ""
    },
    {
      "id": "prNumber",
      "type": "promptString",
      "description": "Enter GitHub PR number",
      "default": ""
    }
  ]
}
